<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Loanratus Admin</title>
    <meta name="description" content="Loanratus Admin">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-icon.png">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <link rel="stylesheet" href="assets/css/lib/datatable/dataTables.bootstrap.min.css">
    <!-- <link rel="stylesheet" href="assets/css/bootstrap-select.less"> -->
    <link rel="stylesheet" href="assets/scss/style.css">
    <link rel="stylesheet" href="assets/css/lib/chosen/chosen.min.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">


    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->

    <!--//Fusion Chart-->
    <!--<script type="text/javascript" src="fscharts/integrations/jquery/js/jquery-fusioncharts.min.js"></script>-->
</head>
<body class="open">
<!-- Left Panel -->
<script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function($){ check(); loadMenus(); read_write();});
</script>

<style>
    #regForm {
        background-color: rgba(255, 255, 255, 0.44);
        /*margin: 100px auto;*/
        padding: 20px;
        /*width: 70%;*/
        /*!*min-width: 300px;*!*/
    }

    /* Hide all steps by default: */
    .tab {
        display: none;
    }

    /* Make circles that indicate the steps of the form: */
    .step {
        height: 15px;
        width: 15px;
        margin: 0 2px;
        background-color: #bbbbbb;
        border: none;
        border-radius: 50%;
        display: inline-block;
        opacity: 0.5;
    }

    /* Mark the active step: */
    .step.active {
        opacity: 1;
    }

    /* Mark the steps that are finished and valid: */
    .step.finish {
        background-color: #4CAF50;
    }
</style>

<aside id="left-panel" class="left-panel">
    <nav class="navbar navbar-expand-sm navbar-default">

        <div class="navbar-header">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fa fa-bars"></i>
            </button>
            <a class="navbar-brand" href="/dashboard">Loanratus</a>
            <a class="navbar-brand hidden" href="/dashboard">35</a>
        </div>

        <div id="main-menu" class="main-menu collapse navbar-collapse">
            <ul id="sidebar" class="nav navbar-nav"></ul>
        </div>
    </nav>
</aside><!-- /#left-panel -->

<!-- Left Panel -->

<!-- Right Panel -->

<div id="right-panel" class="right-panel">

    <!-- Header-->
    <header id="header" class="header">

        <div class="header-menu">

            <div class="col-sm-7">
                <a id="menuToggle" class="menutoggle pull-left"><i class="fa fa fa-tasks"></i></a>
                <div class="header-left">
                </div>
            </div>

            <div class="col-sm-5">
                <div class="user-area dropdown float-right">
                    <strong id="user" style="margin-right:10px; vertical-align: sub"></strong>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img class="user-avatar rounded-circle" src="images/admin.jpg" alt="User Avatar">
                    </a>

                    <div class="user-menu dropdown-menu">
                        <a class="nav-link pull-right" href="#" onclick="logout()"><i class="fa fa-power-off"></i> Logout</a>
                        <script type="text/javascript">
                            function logout() {
                                localStorage.login = "0";
                                window.location.href = "/logout";
                            }
                        </script>
                    </div>
                </div>
            </div>
        </div>

    </header><!-- /header -->
    <!-- Header-->

    <div class="breadcrumbs">
        <div class="col-sm-4">
            <div class="page-header float-left">
                <div class="page-title">
                    <h1>Loan Reports</h1>
                </div>
            </div>
        </div>
        <div class="col-sm-8">
            <div class="page-header float-right">
                <div class="page-title">
                    <ol class="breadcrumb text-right">
                        <li><a href="#">Dashboard</a></li>
                        <li><a href="#">Loan Reports</a></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="content mt-3">
        <div class="animated fadeIn">

            <div class="row">
                <div class="card col-sm-12">
                    <div class="card-body">
                        <div class="col-sm-12">
                            <div class="card" style="border-color: transparent">
                                <div class="row">
                                    <!--<div class="col-sm-2">-->
                                        <!--<div class="card text-white bg-flat-color-1">-->
                                            <!--<div class="card-body pb-0" style="text-align: center">-->
                                                <!--<h3 id="branch" class="mb-0"></h3>-->
                                                <!--<p class="text-light">Branches</p>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="col-sm-2">-->
                                        <!--<div class="card text-white bg-flat-color-1">-->
                                            <!--<div class="card-body pb-0" style="text-align: center">-->
                                                <!--<h3 id="loan-officers" class="mb-0"></h3>-->
                                                <!--<p class="text-light">Loan Officers</p>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="loans-active" class="mb-0"></h3>
                                                <p class="text-light">Loan(s) Active</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="loan-per" class="mb-0"></h3>
                                                <p class="text-light">Loans Per Loan Officer</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="avg-loan-balance" class="mb-0"></h3>
                                                <p class="text-light">Average Loan Balance</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="avg-loan-disbursed" class="mb-0"></h3>
                                                <p class="text-light">Average Loans Disbursed</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" href="#intelliboard" role="tab" data-toggle="tab">Disbursed Loans Report</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#org-reports" role="tab" data-toggle="tab">Interest Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#risk-reports" role="tab" data-toggle="tab">Risk Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#fin-reports" role="tab" data-toggle="tab">Payments</a>
                                </li>
                                <!--<li class="nav-item">-->
                                    <!--<a class="nav-link" href="#cust-reports" role="tab" data-toggle="tab">Custom Reports</a>-->
                                </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane fade active show in" id="intelliboard">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row" style="padding: 20px">
                                                <div class="col-sm-6">
                                                    <button id="disburse-button" class="btn btn-primary col-sm-12">Disbursements</button>
                                                </div>
                                                <div class="col-sm-6">
                                                    <button id="loan-branch-button" class="btn btn-block col-sm-12">Loans By Branch</button>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div id="disbursement-div" class="col-sm-12" >
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="chartfilterofficers" onchange="dFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="dis-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="disburse-frequency" onchange="dFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="dis-year" style="background-color: transparent; border-color: transparent; display: none">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="disburse-year" onchange="dFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="chart-container" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong>Disbursements</strong>
                                                                <span style="float: right">Total: <span id="total-disbursements"></span></span>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterdisbursements" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="startDate" placeholder="Start date">
                                                                    </div>&nbsp;
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="endDate" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="filter-officers" onchange="filterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <!--<option value="1" selected="selected">All</option>-->
                                                                    <!--<option value="2">Started</option>-->
                                                                    <!--<option value="3">Pending Approval</option>-->
                                                                    <!--<option value="4">Pending Disbursal</option>-->
                                                                    <!--<option value="5">Active</option>-->
                                                                    <!--<option value="6">Closed</option>-->
                                                                </select>
                                                                </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="disbursed-table" class="table table-striped table-bordered" width="100%">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Name</th>
                                                                    <th>Principal</th>
                                                                    <th>Balance</th>
                                                                    <th>Date Created</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="loan-by-branch-div" style="display: none" >
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="reportview" onchange="changeview(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="1">Single Chart</option>
                                                                        <option value="2">Comparison Chart</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branchreport" onchange="changereport(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="1">Disbursements</option>
                                                                        <option value="2">Interests</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3 card" id="sel-brn" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="chartfilterbranches" onchange="bFilterBranch(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-2 card" id="brn-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branch-frequency" onchange="bFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3 card" id="brn-year" style="background-color: transparent; border-color: transparent; display: none">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branch-year" onchange="bFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="branch-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Loans by Branch</strong>&nbsp;&nbsp;&nbsp;
                                                                <span>Total: <span id="total-loans-by-branch"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterbybranch" class="form-inline" style="float: right;">
                                                                <div class="form-group">
                                                                    <label class="" for="startDate">Start date</label>
                                                                    <input type="date" class="form-control" id="filterbranchstart" placeholder="Start date">
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="" for="endDate">End date</label>
                                                                    <input type="date" class="form-control" id="filterbranchend" placeholder="End date">
                                                                </div>
                                                                <button type="submit" class="btn btn-success">Filter</button>
                                                            </form>
                                                            </div>
                                                            <!--<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">-->
                                                            <!--</select>-->
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="loan-by-branch-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Branch ID</th>
                                                                    <th>Branch Name</th>
                                                                    <th>Disbursed</th>
                                                                    <th>Collected</th>
                                                                    <th>GLP</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="org-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="gross-projected-interest-button" class="btn btn-block col-sm-12">Projected Interests</button>
                                                    </div>
                                                    <!--<div class="col-sm-6">-->
                                                        <!--<button id="projected-interest-button" class="btn col-sm-12">Projected Interest</button>-->
                                                    <!--</div>-->
                                                    <div class="col-sm-6">
                                                        <button id="interests-received-button" class="btn btn-block col-sm-12">Interests Received</button>
                                                    </div>
                                                </div>
                                                <!--<div class="row">-->
                                                <!--</div>-->
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="agg-prj-int-div" style="display: none">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Projected Interests: </strong>
                                                                <span id="agg-interests"></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filteraggprojectedinterest" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filteraggprointstart" name="filteraggprointstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filteraggprointend" name="filteraggprointend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <div class="col-sm-3"></div>
                                                            <div class="col-sm-6">
                                                                <div class="card text-white bg-flat-color-4">
                                                                    <div class="card-body pb-0" style="text-align: center">
                                                                        <h3 id="total-projected-interest" class="mb-0"></h3>
                                                                        <p class="text-light"></p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="interests-received-div" style="display: none" class="col-sm-6">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="irchartfilterofficers" onchange="irFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="ir-frequency" onchange="irFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="i-r-year" onchange="irFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="interest-received-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Interests Received</strong>
                                                                <span>Total: <span id="total-interests-earned"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterinterests" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterintereststart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterinterestend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="interests-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Interest Received</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div><!--<div class="col-sm-12">-->
                                                <!--<div id="projected-interests-div" style="display: none" class="col-sm-6">-->
                                                    <!--<div class="card">-->
                                                        <!--<div class="card-header">-->
                                                            <!--<div class="col-sm-5">-->
                                                                <!--<strong>Projected Interest</strong>-->
                                                                <!--<span >Total: <span id="total-interests"></span></span>-->
                                                            <!--</div>-->
                                                            <!--<div class="col-sm-7">-->
                                                                <!--<form id="filterprojectedinterest" class="form-inline" style="float: right;">-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="startDate">Start date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterprointstart" placeholder="Start date">-->
                                                                    <!--</div>-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="endDate">End date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterprointend" placeholder="End date">-->
                                                                    <!--</div>-->
                                                                    <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                                <!--</form>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="card-body">-->
                                                            <!--<table id="projected-interests-table" class="table table-striped table-bordered">-->
                                                                <!--<thead>-->
                                                                <!--<tr>-->
                                                                    <!--<th>Client ID</th>-->
                                                                    <!--<th>Name</th>-->
                                                                    <!--<th>Projected Interest</th>-->
                                                                <!--</tr>-->
                                                                <!--</thead>-->
                                                                <!--<tbody></tbody>-->
                                                            <!--</table>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                            <!--</div>--></div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="risk-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="overdue-loans-button" class="btn col-sm-12">Overdue Loans</button>
                                                        </div>
                                                    <div class="col-sm-6">
                                                            <button id="bad-loans-button" class="btn btn-block col-sm-12">Bad Loans </button>
                                                        </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <button id="glp-button" class="btn btn-block col-sm-12">Gross Loan Portfolio</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="bad-loans-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Bad Loans</strong>
                                                                <span >Total: <span id="total-badloans"></span></span>
                                                            </div>
                                                            <div class="col-sm-4">
                                                                <!--<form id="filterbadloans" class="form-inline" style="float: right;">-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="startDate">Start date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterbadloanstart" placeholder="Start date">-->
                                                                    <!--</div>-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="endDate">End date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterbadloanend" placeholder="End date">-->
                                                                    <!--</div>-->
                                                                    <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                                <!--</form>-->
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="badloans-officers" onchange="blfilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="bad-loans-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal </th>
                                                                    <th>Principal Due</th>
                                                                    <th>Due Date</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="overdue-loans-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3">
                                                                <strong>Overdue Loans</strong>
                                                                <span >Total: <span id="total-overdue"></span></span>
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <form id="filteroverdueloans" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filteroverduestart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filteroverdueend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <div class="col-sm-3" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="overdue-officers" onchange="odfilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="overdues-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal</th>
                                                                    <th>Principal Due</th>
                                                                    <th>Interest Due</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="glp-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5" style="background-color: transparent; border-color: transparent">
                                                                <strong>Gross Loan Portfolio</strong>
                                                                <span>Total: <span id="glp"></span></span>
                                                            </div>
                                                            <div class="col-sm-7" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterglp" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="startGLPDate" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="endGLPDate" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="glp-table" class="table table-striped table-bordered" width="100%">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Name</th>
                                                                    <th>Principal</th>
                                                                    <th>Balance</th>
                                                                    <th>Date Created</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="fin-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="pchartfilterofficers" onchange="pFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pay-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="payment-frequency" onchange="pFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pay-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="payment-year" onchange="pFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="payments-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <strong>Payments</strong>
                                                            <form id="filterpayments" class="form-inline" style="float: right;">
                                                                <div class="form-group">
                                                                    <label class="" for="startDate">Start date</label>
                                                                    <input type="date" class="form-control" id="paystart" placeholder="Start date">
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="" for="endDate">End date</label>
                                                                    <input type="date" class="form-control" id="payend" placeholder="End date">
                                                                </div>
                                                                <button type="submit" class="btn btn-success">Filter</button>
                                                            </form>
                                                            <span style="float: inherit">Total: <span id="total-payments" ></span></span>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="payments-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Client ID</th>
                                                                    <th>Name</th>
                                                                    <th>Paid (Principal + Interest)</th>
                                                                    <th>Last Payment</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="cust-reports">ccc</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div><!-- .animated -->
        <div id="wait" style=";width:150px;height:100px;position:fixed;top:50%;left:50%;padding:2px;z-index:99999;"><img src='spinner.gif' width="100" height="100" style="background-color: transparent"/></div>
    </div><!-- .content -->


</div><!-- /#right-panel -->

<!-- Right Panel -->

<script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/plugins.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/js/lib/chosen/chosen.jquery.min.js"></script>


<script src="assets/js/lib/data-table/datatables.min.js"></script>
<script src="assets/js/lib/data-table/dataTables.bootstrap.min.js"></script>
<script src="assets/js/lib/data-table/dataTables.buttons.min.js"></script>
<script src="assets/js/lib/data-table/buttons.bootstrap.min.js"></script>
<script src="assets/js/lib/data-table/jszip.min.js"></script>
<script src="assets/js/lib/data-table/pdfmake.min.js"></script>
<script src="assets/js/lib/data-table/vfs_fonts.js"></script>
<script src="assets/js/lib/data-table/buttons.html5.min.js"></script>
<script src="assets/js/lib/data-table/buttons.print.min.js"></script>
<script src="assets/js/lib/data-table/buttons.colVis.min.js"></script>
<script src="assets/js/lib/data-table/datatables-init.js"></script>
<!--<script-->
        <!--type="text/javascript"-->
        <!--src="https://code.jquery.com/jquery-3.3.1.min.js"-->
<!--&gt;</script>-->
<script
        type="text/javascript"
        src="https://unpkg.com/fusioncharts/fusioncharts.js"
></script>
<script
        type="text/javascript"
        src="https://unpkg.com/fusioncharts/themes/fusioncharts.theme.fusion.js"
></script>

<script type="text/javascript" src="fscharts/js/fusioncharts.js"></script>
<script type="text/javascript" src="fscharts/integrations/jquery/js/jquery-fusioncharts.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.fusion.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.candy.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.carbon.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.gammel.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.ocean.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.fint.js"></script>
<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.zune.js"></script>
<script>
    jQuery(document).ready(function() {
        loadYears('disburse-year');
        loadYears('branch-year');
        loadYears('payment-year');
        loadYears('i-r-year');
        getOfficers();
        getBranches();
        loadInfo();
        loadDisbursed();
        loadGLP();
        loadPayments();
//        loadLoansByBranch();
//        loadProjectedInterests();
        loadInterestReceived();
        loadBadLoans();
        loadOverdues();
        loadAggProjectedInterests();
        disbursed();
        branches($('#branchreport').val());
        payments();
        interestreceived();
        var today = new Date().toISOString().split('T')[0];
        document.getElementsByName("filteraggprointend")[0].setAttribute('min', today);
        document.getElementsByName("filteraggprointstart")[0].setAttribute('min', today);
    });

    function loadYears(id){
        var max = new Date().getFullYear(),
            min = max - 10,
            select = document.getElementById(id);

        for (var i = max; i>=min; i--){
            var opt = document.createElement('option');
            opt.value = i;
            opt.innerHTML = i;
            select.appendChild(opt);
        }
    }

    const formatter = new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'NGN'
    });

    var myTable = $('#disbursed-table')
        .DataTable({
            bAutoWidth: false,
            "aoColumns": [
                { "bSortable": false }, { "bSortable": true },
                null, null, { "bSortable": true },
            ],
            "aaSorting": [],
//            "bSearchable": false,
            select: {
                style: 'multi'
            }
        });

    var myTable2 = $('#payments-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable3 = $('#loan-by-branch-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable4 = $('#projected-interests-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true }, { "bSortable": true }
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable5 = $('#interests-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true }, { "bSortable": true }
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable6 = $('#bad-loans-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable7 = $('#overdues-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable8 = $('#glp-table')
        .DataTable({
            bAutoWidth: false,
            "aoColumns": [
                { "bSortable": false }, { "bSortable": true },
                null, null, { "bSortable": true },
            ],
            "aaSorting": [],
//            "bSearchable": false,
            select: {
                style: 'multi'
            }
        });

    $(document).ajaxStart(function(){
        $("#wait").css("display", "block");
    });

    $(document).ajaxComplete(function(){
        $("#wait").css("display", "none");
    });

    $(document).on("click", "#disburse-button", function (e) {
        $("#loan-by-branch-div").hide();
        $("#disbursement-div").attr('class', 'col-sm-12');
        $("#disbursement-div").show();
        $("#disburse-button").attr('class', 'btn btn-primary col-sm-12');
        $("#loan-branch-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#loan-branch-button", function (e) {
        loadLoansByBranch();
        $("#loan-by-branch-div").show();
        $("#loan-by-branch-div").attr('class', 'col-sm-12');
        $("#disbursement-div").hide();
        $("#loan-branch-button").attr('class', 'btn btn-primary col-sm-12');
        $("#disburse-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#projected-interest-button", function (e) {
        $("#projected-interests-div").show();
        $("#projected-interests-div").attr('class', 'col-sm-12');
        $("#interests-received-div").hide();
        $("#agg-prj-int-div").hide();
        $("#projected-interest-button").attr('class', 'btn btn-primary col-sm-12');
        $("#interests-received-button").attr('class', 'btn col-sm-12');
        $("#gross-projected-interest-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#interests-received-button", function (e) {
        $("#interests-received-div").show();
        $("#interests-received-div").attr('class', 'col-sm-12');
        $("#projected-interests-div").hide();
        $("#agg-prj-int-div").hide();
        $("#interests-received-button").attr('class', 'btn btn-primary col-sm-12');
        $("#projected-interest-button").attr('class', 'btn col-sm-12');
        $("#gross-projected-interest-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#gross-projected-interest-button", function (e) {
        $("#agg-prj-int-div").show();
        $("#agg-prj-int-div").attr('class', 'col-sm-12');
        $("#projected-interests-div").hide();
        $("#interests-received-div").hide();
        $("#gross-projected-interest-button").attr('class', 'btn btn-primary col-sm-12');
        $("#projected-interest-button").attr('class', 'btn col-sm-12');
        $("#interests-received-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#overdue-loans-button", function (e) {
        $("#overdue-loans-div").show();
        $("#overdue-loans-div").attr('class', 'col-sm-12');
        $("#bad-loans-div").hide();
        $("#glp-div").hide();
        $("#overdue-loans-button").attr('class', 'btn btn-primary col-sm-12');
        $("#bad-loans-button").attr('class', 'btn col-sm-12');
        $("#glp-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#bad-loans-button", function (e) {
        $("#bad-loans-div").show();
        $("#bad-loans-div").attr('class', 'col-sm-12');
        $("#overdue-loans-div").hide();
        $("#glp-div").hide();
        $("#bad-loans-button").attr('class', 'btn btn-primary col-sm-12');
        $("#overdue-loans-button").attr('class', 'btn col-sm-12');
        $("#glp-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#glp-button", function (e) {
        $("#glp-div").show();
        $("#glp-div").attr('class', 'col-sm-12');
        $("#overdue-loans-div").hide();
        $("#bad-loans-div").hide();
        $("#glp-button").attr('class', 'btn btn-primary col-sm-12');
        $("#overdue-loans-button").attr('class', 'btn col-sm-12');
        $("#bad-loans-button").attr('class', 'btn col-sm-12');
    });

    function check(){
        if (localStorage.getItem('role') != 1){
            jQuery('#car-models').hide();
            jQuery('#new-user').hide();
            jQuery('#models-card').hide();
            jQuery('#user').html(localStorage.getItem("name"));
        }
        else{
            jQuery('#user').html(localStorage.getItem("name"));
//                jQuery('#h-role').html(localStorage.getItem("user"));
        }
    }

    function loadMenus(){
        var modules = {};
        modules = JSON.parse(localStorage.getItem("modules"));
        modules.forEach(function(k, v){
            if (k.menu_name === 'Sub Menu'){
                let main = $.grep(modules, function(e){return e.id === parseInt(k.main_menu);});
                $('#'+$(main[0]['module_tag']).attr('id') + ' > .sub-menu').append(k.module_tag);
            }else if(k.menu_name === 'Main Menu'){
                $('#sidebar').append(k.module_tag);
                $('#'+$(k.module_tag).attr('id')).append('<ul class="sub-menu children dropdown-menu"></ul>');
            }else{
                $('#'+k.module_name).show();
            }
        });
        $.ajax({
            type: "GET",
            url: "/user/all-requests",
            success: function (response) {
                $.each(response, function(k,v){
                    $('#requests-badge').html(v.requests);
                });
            }
        });
        $.ajax({
            type: "GET",
            url: "/user/all-applications",
            success: function (response) {
                $.each(response, function(k,v){
                    $('#applications-badge').html(v.applications);
                });
            }
        });
    }

    function read_write(){
        let w;
        var perms = JSON.parse(localStorage.getItem("permissions"));
        var page = (window.location.pathname.split('/')[1].split('.'))[0];
        perms.forEach(function (k,v){
            if (k.module_name === page){
                w = $.grep(perms, function(e){return e.id === parseInt(k.id);});
            }
        });
        if (w && w[0] && (parseInt(w[0]['editable']) !== 1)){
            $(".write").hide();
        }
    }

    function padWithZeroes(n, width, z) {
        z = z || '0';
        n = n + '';
        return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
    }

    function loadInfo(){
        $.ajax({
            'url': 'user/report-cards/',
            'type': 'get',
            'success': function (data) {
                populateCards(data.response);
            },
            'error': function (err) {
                //alert ('Error');
                console.log('Error');
            }
        });
    }

    function populateCards(data){
        $('#branch').html(data.branches[0]["branches"]);
        $('#loan-officers').html(data.loan_officers[0]["loan_officers"]);
        $('#loans-active').html(data.active_loans[0]["all_applications"]);
        $('#loan-per').html(data["avg_loan_per_officers"]);
    }

    function loadDisbursed(){
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadGLP(){
        let start = $("#startGLPDate").val(),
            end = $("#endGLPDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateGLP(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateDisbursed(dets){
        $("#disbursed-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#disbursed-table").dataTable().fnClearTable();
        }else{
            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
            let d = [];
            jQuery.each(dets.with_payments, function(k, v){
                loa += v.loan_amount;
                num_all++;
                num_paid++;
                total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                pay+=v.valid_payment;
                totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0
                $("#disbursed-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.applicationID),6),
                    v.fullname,
                    formatter.format(parseFloat(v.loan_amount)),
//                    formatter.format(parseFloat(v.loan_amount - (parseFloat(v.paid) - parseFloat((v.invalid_payment === null) ? 0 : v.invalid_payment)))),
                    formatter.format(parseFloat(v.loan_amount - v.valid_payment)),
                    formatDate(v.date)
                ]);
//                if (!(parseFloat(v.loan_amount - (parseFloat(v.paid) - parseFloat((v.invalid_payment === null) ? 0 : v.invalid_payment))) === 0)){
//                if (!(parseFloat(v.loan_amount - (parseFloat(v.paid)) === 0))){
//                if (!(parseFloat(v.loan_amount - v.valid_payment) === 0)){
//                if ((parseFloat(v.loan_amount - v.valid_payment) > 0)){
////                    totalglp += (v.loan_amount) ? parseFloat(v.loan_amount - (parseFloat(v.paid) - parseFloat((v.invalid_payment === null) ? 0 : v.invalid_payment))) : 0
//                    totalglp += (v.loan_amount) ? parseFloat(v.loan_amount - v.valid_payment) : 0
//                    pay+=v.valid_payment;
////                    console.log((v.loan_amount - v.valid_payment) + ' -> ' +totalglp);
//                    $("#glp-table").dataTable().fnAddData([
//                        padWithZeroes(parseInt(v.applicationID),6),
//                        v.fullname,
//                        formatter.format(parseFloat(v.loan_amount)),
////                        formatter.format(parseFloat(v.loan_amount - (parseFloat(v.paid) - parseFloat((v.invalid_payment === null) ? 0 : v.invalid_payment)))),
//                        formatter.format(parseFloat(v.loan_amount - v.valid_payment)),
//                        formatDate(v.date)
//                    ]);
//                }
            });
            var totalhere = 0;
            jQuery.each(dets.without_pay, function(k, v){
//                loans+=v.loan_amount;
                totalhere += parseFloat(v.loan_amount);
                total+= (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                totalglp += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                console.log(v.loan_amount + ' -> ' + totalglp);
                totalbalance += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                num_all++;
                $("#disbursed-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.ID),6),
                    v.fullname,
                    formatter.format(parseFloat(v.loan_amount)),
                    formatter.format(parseFloat(v.loan_amount)),
                    formatDate(v.disbursement_date)
                ]);
            });
            $('#total-disbursements').html(formatter.format(total));
//            $('#glp').html(formatter.format(totalglp));
//            $('#avg-loan-balance').html(formatter.format((num_all === 0) ? 0: totalbalance/num_all));
//            $('#avg-loan-disbursed').html(formatter.format((num_all === 0) ? 0: total/num_all));
        }
    }

    function populateGLP(dets){
        $("#glp-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#glp-table").dataTable().fnClearTable();
        }else{
            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
            jQuery.each(dets.with_payments, function(k, v){
                loa += v.loan_amount;
                num_all++;
                num_paid++;
                total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                pay+=v.valid_payment;
                totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0
                if ((parseFloat(v.loan_amount - v.valid_payment) > 0)){
                    totalglp += (v.loan_amount) ? parseFloat(v.loan_amount - v.valid_payment) : 0
                    pay+=v.valid_payment;
                    $("#glp-table").dataTable().fnAddData([
                        padWithZeroes(parseInt(v.applicationID),6),
                        v.fullname,
                        formatter.format(parseFloat(v.loan_amount)),
                        formatter.format(parseFloat(v.loan_amount - v.valid_payment)),
                        formatDate(v.date)
                    ]);
                }
            });
            var totalhere = 0;
            jQuery.each(dets.without_pay, function(k, v){
                totalhere += parseFloat(v.loan_amount);
                total+= (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                totalglp += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                console.log(v.loan_amount + ' -> ' + totalglp);
                totalbalance += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                num_all++;
                $("#glp-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.ID),6),
                    v.fullname,
                    formatter.format(parseFloat(v.loan_amount)),
                    formatter.format(parseFloat(v.loan_amount)),
                    formatDate(v.date_modified)
                ]);
            });
            $('#glp').html(formatter.format(totalglp));
            $('#avg-loan-balance').html(formatter.format((num_all === 0) ? 0: totalbalance/num_all));
            $('#avg-loan-disbursed').html(formatter.format((num_all === 0) ? 0: total/num_all));
        }
    }

    $("#filterdisbursements").submit(function (e) {
        e.preventDefault();

        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            type = $("#type-filter").val(),
            officer = $('#filter-officers').find('option:selected').attr('id'),
            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        let urlAn;
        if (start && end && officer==0){
            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end);
            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadDisbursed();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end)+'&&officer='+officer;
        }
        let d=[];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateDisbursed(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name)
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    if (v.DisburseYearMonth)
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, );

                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount Disbursed (Naira)",
                            "numberSuffix": " Naira",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    });

    $("#filterglp").submit(function (e) {
        e.preventDefault();

        let start = $("#startGLPDate").val(),
            end = $("#endGLPDate").val(),
            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end ) {
            return loadGLP();
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateGLP(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadPayments(){
        let start = $("#paystart").val(),
            end = $("#payend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/payments/' : 'user/payments?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populatePayments(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populatePayments(dets){
        $("#payments-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#payments-table").dataTable().fnClearTable();
        }else{
            var total = 0;
            jQuery.each(dets.payment, function(k, v){
                $("#payments-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.clientid),6),
                    v.fullname,
                    formatter.format(parseFloat(v.paid + v.interest)),
                    v.date
                ]);
            });
            total = dets.total[0]["total"];
            $('#total-payments').html(formatter.format(total));
        }
    }

    $("#filterpayments").submit(function (e) {
        e.preventDefault();

        let start = $("#paystart").val(),
            end = $("#payend").val(),
            url = '/user/payments/?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadPayments();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePayments(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadLoansByBranch(){
        let start = $("#filterbranchstart").val(),
            end = $("#filterbranchend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/loans-by-branches/' : 'user/loans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateLoanByBranch(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateLoanByBranch(dets){
        $("#loan-by-branch-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#loan-by-branch-table").dataTable().fnClearTable();
            $('#total-loans-by-branch').html(formatter.format(0));
        }else{
            var total = 0; var collected = 0;
            jQuery.each(dets, function(k, v){
                total += (v.disbursed) ? v.disbursed : 0;
                $("#loan-by-branch-table").dataTable().fnAddData([
                    padWithZeroes(v.branchID, 6),
                    v.branch,
                    formatter.format(v.disbursed),
                    formatter.format(v.collected),
                    formatter.format(v.disbursed - v.collected)
                ]);
                collected = v.collected;
            });
//            console.log(collected);
            $('#total-loans-by-branch').html(formatter.format(total));
        }
    }

    $("#filterbybranch").submit(function (e) {
        e.preventDefault();

        let start = $("#filterbranchstart").val(),
            end = $("#filterbranchend").val(),
            url = '/user/loans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadLoansByBranch();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateLoanByBranch(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadProjectedInterests(){
        let start = $("#filterprointstart").val(),
            end = $("#filterprointend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/projected-interests/' : 'user/projected-interests?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': 'user/projected-interests/',
            'type': 'get',
            'success': function (data) {
                populateProjectedInterests(data);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateProjectedInterests(dets){
        $("#projected-interests-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#projected-interests-table").dataTable().fnClearTable();
        }else{
            let full = [],
                total = 0;

            dets.response.due.forEach(function (applications) {
                let payments = $.grep(dets.response.paid, function (e) {return e.applicationID === applications.applicationID});
                if (payments && payments[0])
                    applications.payments = payments[0]['interest_paid'];
                full.push(applications);
            });
            $.each(full, function(k,v){
                if (v.payments){
                    if ((v.interest_due - v.payments) > 0 ){
                        total+= parseFloat(v.interest_due - v.payments);
                        $("#projected-interests-table").dataTable().fnAddData([
                            padWithZeroes(v.clientID, 6), v.client, formatter.format(parseFloat(v.interest_due - v.payments))
                        ]);
                    }
                }else{
                    total += parseFloat(v.interest_due - 0)
                    $("#projected-interests-table").dataTable().fnAddData([
                        padWithZeroes(v.clientID, 6), v.client, formatter.format(parseFloat(v.interest_due - 0))
                    ]);
                }
            });
            $('#total-interests').html(formatter.format(total));
        }
    }

    $("#filterprojectedinterest").submit(function (e) {
        e.preventDefault();

        let start = $("#filterprointstart").val(),
            end = $("#filterprointend").val(),
            url = '/user/projected-interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadProjectedInterests();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data;
                results = applications;
                populateProjectedInterests(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadAggProjectedInterests(){
        let start = $("#filteraggprointstart").val(),
            end = $("#filteraggprointend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/agg-projected-interests/' : 'user/agg-projected-interests?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': 'user/agg-projected-interests/',
            'type': 'get',
            'success': function (data) {
                var value = data.response[0]['total'];
                $('#total-projected-interest').html(formatter.format(value));
                $('#agg-interests').html(formatter.format(value));
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    $("#filteraggprojectedinterest").submit(function (e) {
        e.preventDefault();

        let start = $("#filteraggprointstart").val(),
            end = $("#filteraggprointend").val(),
            url = '/user/agg-projected-interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadAggProjectedInterests();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                var value = data.response[0]['total'];
                $('#total-projected-interest').html(formatter.format(value));
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadInterestReceived(){
        let start = $("#filterintereststart").val(),
            end = $("#filterinterestend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/interests' : 'user/interests?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateInterestReceived(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateInterestReceived(dets){
        $("#interests-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#interests-table").dataTable().fnClearTable();
            $('#total-interests-earned').html(formatter.format(0));
        }else{
            var total = 0;
            jQuery.each(dets, function(k, v){
                total+= parseFloat(v.paid);
                $("#interests-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.applicationID),6),
                    v.fullname,
                    formatter.format(parseFloat(v.paid))
                ]);
            });
            $('#total-interests-earned').html(formatter.format(total));
        }
    }

    $("#filterinterests").submit(function (e) {
        e.preventDefault();

        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            type = $("#type-filter").val(),
            url = '/user/interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadInterestReceived();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestReceived(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadBadLoans(){
//        let start = $("#filterbadloanstart").val(),
//            end = $("#filterbadloanend").val(),
//            url;
//        url = (start === "" || start === null || end === "" || end === null ) ? 'user/overdues' : 'user/overdues?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/badloans',
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateBadLoans(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateBadLoans(dets){
        $("#bad-loans-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#bad-loans-table").dataTable().fnClearTable();
            $('#total-badloans').html(formatter.format(0));
        }else{
            var total = 0;
            var oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1;
            var yyyy = today.getFullYear();
            var now = yyyy+'-'+mm+'-'+dd;
            now = new Date(now);
//            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
            jQuery.each(dets, function(k, v){
                var duedate = new Date(v.duedate);
                if ((Math.round((now.getTime() - duedate.getTime())/(oneDay))) > 90){
                    total+= parseFloat(v.amount_due);
                    $("#bad-loans-table").dataTable().fnAddData([
                        padWithZeroes(parseInt(v.applicationID),6),
                        v.client,
                        formatter.format(parseFloat(v.principal)),
                        formatter.format(parseFloat(v.amount_due)),
                        v.duedate
                    ]);
                }
            });
            $('#total-badloans').html(formatter.format(total));
        }
    }

    $("#filterbadloans").submit(function (e) {
        e.preventDefault();

        let start = $("#filterbadloanstart").val(),
            end = $("#filterbadloanend").val(),
            url = '/user/overdues?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadBadLoans();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadLoans(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadOverdues(){
        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/overdues' : 'user/overdues?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateOverdues(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

//    function populateOverdues(dets){
//        $("#overdues-table").dataTable().fnClearTable();
//        if (dets.length === 0){
//            $("#overdues-table").dataTable().fnClearTable();
//            $('#total-overdue').html(formatter.format(0));
//        }else{
//            var total = 0;
//            var today = new Date();
//            var dd = today.getDate();
//            var mm = today.getMonth()+1;
//            var yyyy = today.getFullYear();
//            var now = yyyy+'-'+mm+'-'+dd;
//            jQuery.each(dets, function(k, v){
//                var ddate = new Date(v.duedate);
//                now = new Date(now);
//                if (ddate < now){
//                    total+= parseFloat(v.amount_due);
//                    $("#overdues-table").dataTable().fnAddData([
//                        padWithZeroes(parseInt(v.applicationID),6),
//                        v.client,
//                        formatter.format(parseFloat(v.principal)),
//                        formatter.format(parseFloat(v.amount_due)),
//                        formatter.format(parseFloat(v.interest_due))
//                    ]);
//                }
//            });
//            $('#total-overdue').html(formatter.format(total));
//        }
//    }

    function populateOverdues(dets){
        $("#overdues-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#overdues-table").dataTable().fnClearTable();
            $('#total-overdue').html(formatter.format(0));
        }else{
            var total = 0;
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1;
            var yyyy = today.getFullYear();
            var now = yyyy+'-'+mm+'-'+dd;
            jQuery.each(dets, function(k, v){
                total+= parseFloat(v.amount_due);
                $("#overdues-table").dataTable().fnAddData([
                    padWithZeroes(parseInt(v.applicationID),6),
                    v.client,
                    formatter.format(parseFloat(v.principal)),
                    formatter.format(parseFloat(v.amount_due)),
                    formatter.format(parseFloat(v.interest_due))
                ]);
            });
            $('#total-overdue').html(formatter.format(total));
        }
    }

    $("#filteroverdueloans").submit(function (e) {
        e.preventDefault();

        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url = '/user/overdues?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadOverdues();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateOverdues(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function formatDate(date) {
        if (!date)
            return '1970-01-01';
        let separator;
        if (date.indexOf('-') > -1){
            separator = '-';
        } else if (date.indexOf('/') > -1){
            separator = '/';
        } else {
            return date;
        }
        let date_array = date.split(separator);
        return date_array[0]+'-'+date_array[1]+'-'+date_array[2];
    }

    function getOfficers(){
        $.ajax({
            type: "GET",
            url: "/user/users-list/",
            data: '{}',
            success: function (response) {
                var role = $("[id=filter-officers]");
                role.empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#overdue-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#badloans-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#chartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#pchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#irchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $.each(JSON.parse(response), function (key, val) {
                    $("#filter-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#overdue-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#badloans-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#chartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#pchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#irchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                });
            }
        });
    }

    function filterOfficer(officer) {
        let urlAn = '/user/analytics?t=disbursements&&';
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url = '/user/disbursements/filter?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
            urlAn = urlAn.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadDisbursed();
        }
        url = url.concat('officer='+officer.value);
        urlAn = urlAn.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateDisbursed(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function blfilterOfficer(officer) {
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url = '/user/badloans?',
            d=[], agent;
        if (officer.value == 0){
            return loadBadLoans();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadLoans(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function odfilterOfficer(officer) {
        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url = '/user/overdues?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadOverdues();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateOverdues(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    ///Disbursement Chart & Filters

    function disbursed(){
        let d = [];
        let data = [
            {
                "label": "Venezuela",
                "value": "290"
            }, {
                "label": "Saudi",
                "value": "260"
            }, {
                "label": "Canada",
                "value": "180"
            }, {
                "label": "Iran",
                "value": "140"
            }, {
                "label": "Russia",
                "value": "115"
            }, {
                "label": "UAE",
                "value": "100"
            }, {
                "label": "US",
                "value": "30"
            }, {
                "label": "China",
                "value": "30"
            }];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=disbursements',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.name , value: v.amount_disbursed}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFilterOfficer(officer){
        let url = '/user/analytics?t=disbursements&&',
            freq = $('#disburse-frequency').val(),
            year = $('#disburse-year').val();
        if (officer.value == 0 && freq == "-1"){
            return disbursed();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq !== "-1"){
            url = url.concat('&&freq='+freq);
        }
        let d = [], categories = [], agent, xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years';
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFrequencyChange(frequency){
        let url ='user/analytics?t=disbursements&&',
        year = $('#disburse-year').val(),
        officer = $('#chartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#dis-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
//        if (frequency.value == 3){
        else{
            $('#dis-year').hide();
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'')
        }
        let d = [], categories = [], agent, xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years'
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFilterYear(year) {
        let urlAn = '/user/analytics?t=disbursements&&';
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            officer = $('#chartfilterofficers').val(),
            freq = $('#disburse-frequency').val(),
            url = '/user/disbursements/filter?',
            d=[], agent, xaxis;
        url = url.concat('officer='+officer);
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years'
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Loans By Branch Chart & Filters

    function getBranches(){
        $.ajax({
            type: "GET",
            url: "/user/branches/",
            success: function (response) {
                $("#chartfilterbranches").empty().append('<option id="0" value ="0">Select a Branch</option>');
                $.each(JSON.parse(response), function (key, val) {
                    $("#chartfilterbranches").append('<option value = "' + val.id + '" id="' + val.id + '">' + val.branch_name + '</option>');
                });
            }
        });
    }

    function branches(type){
        let d = [], url, report = $('#reportview').val();
        url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+type : 'user/multi-analytics?t=branches&&bt='+type;
        let start = $("#startDate").val(),
            end = $("#endDate").val();
        let yaxis, caption;
        let c = [], dataset = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.branch , value: v.amount_disbursed}, );
                });
                if (type == '1'){
                    yaxis = 'Amount Disbursed (In Naira)';
                    caption = 'Disbursements by Branches'
                }
                if (type == '2'){
                    yaxis = 'Interest Earned (In Naira)';
                    caption = 'Interest Earned by Branches'
                }
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Branches",
                            "yAxisName": yaxis,
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#branch-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function bFilterBranch(branch){
        let url = '/user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&',
            freq = $('#branch-frequency').val(),
            year = $('#branch-year').val();
        if (branch.value == 0){
            swal('', 'You have to choose a branch to continue!', 'warning');
            $('#branch-frequency').val(-1);
            ('#branch-year').val(0);
            $('#brn-year').hide();
            return branches($('#branchreport').val());
        }
        url = url.concat('branch='+branch.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#brn-year').hide();
            $('#branch-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else {
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis, yaxis, caption, categories = [], dataset = [];

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if ($('#branchreport').val() == '1'){
                        yaxis = "Amount Disbursed (Naira)";
                        caption = 'Disbursements by Branches';
                        if (v.branch)
                            d.push({label: v.branch , value: v.amount_disbursed}, );
                        if (v.year){
                            agent = ': '+v.office;
                            xaxis = 'Years'
                            d.push({label: v.year , value: v.AmountDisbursed}, );
                        }
                        if (v.month){
                            agent = ': '+v.office;
                            xaxis = 'Months';
                            d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                        }
                        if (v.Quarter){
                            agent = ': '+v.office;
                            xaxis = 'Quarters'
                            d.push({label: v.Quarter , value: v.AmountDisbursed}, );
                        }
                    }
                    if ($('#branchreport').val() == '2'){
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches: ';
                        if (v.branch)
                            d.push({label: v.branch , value: v.amount_received}, );
                        if (v.PaymentYear){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.PaymentYear , value: v.amount_received}, );
                        }
                        if (v.monthpayed){
                            agent = ': '+v.office;
                            xaxis = 'Period';
                            d.push({label: v.monthpayed , value: v.amount_received}, )
                        }
                        if (v.branchQuarter){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.branchQuarter , value: v.amount_received}, );
                        }
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": yaxis,
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#branch-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

//    function bFrequencyChange(frequency){
//        let url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
//            year = $('#branch-year').val(), report = $('#reportview').val(),
//            branch = $('#chartfilterbranches').val();
////        if (branch == 0){
////            return swal('Please select a branch!', '','warning');
////        }
//        if (frequency.value == 2 || frequency.value == 4){
//            $('#brn-year').show();
//            if (branch && year){
//                url = url.concat('branch='+branch+'&&year='+year+'&&freq='+frequency.value);
//            }
//        }
//        else {
//            $('#brn-year').hide();
//            url = url.concat('branch='+branch+'&&freq='+frequency.value);
//        }
//        let d = [], agent = '', xaxis, yaxis, caption, categories = [], dataset = [];
//
//        $.ajax({
//            'url': url,
//            'type': 'get',
//            'success': function (data) {
////                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
//                if (report == '1'){
//                    jQuery.each(data.response, function(k, v){
//                        if ($('#branchreport').val() == '1') {
//                            yaxis = "Amount Disbursed (Naira)";
//                            caption = 'Disbursements by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.name, value: v.amount_disbursed},);
//                            if (v.year) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.year, value: v.AmountDisbursed},);
//                            }
//                            if (v.month) {
//                                agent = ': ' + v.branch;
//                                xaxis = 'Months';
//                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
//                            }
//                            if (v.Quarter) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
//                            }
//                        }
//                        if ($('#branchreport').val() == '2'){
//                            yaxis = 'Interest Earned (Naira)';
//                            caption = 'Interest Earned by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.branch , value: v.amount_received}, );
//                            if (v.PaymentYear){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.PaymentYear , value: v.amount_received}, );
//                            }
//                            if (v.monthpayed){
//                                agent = ': '+v.office;
//                                xaxis = 'Months';
//                                d.push({label: v.monthpayed , value: v.amount_received}, )
//                            }
//                            if (v.branchQuarter){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.branchQuarter , value: v.amount_received}, );
//                            }
//                        }
//                    });
//                    var chartConfigs = {
//                        type: 'column2d', // The chart type
//                        width: '100%', // Width of the chart
//                        height: '400', // Height of the chart
//                        dataFormat: 'json', // Data type
//                        dataSource: {
//                            // Chart Configuration
//                            "chart": {
//                                "caption": caption+''+agent,
////                            "subCaption": "In MMbbl = One Million barrels",
//                                "xAxisName": xaxis,
//                                "yAxisName": yaxis,
//                                "numberSuffix": " Naira",
//                                "theme": "fusion",
//                            },
//                            // Chart Data
//                            "data": d
//                        }
//                    };
//                }
//                else if (report == '2'){
//                    console.log(data.response)
//                    jQuery.each(data.response, function(k, v){
//                        if ($('#branchreport').val() == '1') {
//                            yaxis = "Amount Disbursed (Naira)";
//                            caption = 'Disbursements by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.name, value: v.amount_disbursed},);
//                            if (v.year) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.year, value: v.AmountDisbursed},);
//                            }
//                            if (v.month) {
//                                agent = ': ' + v.branch;
//                                xaxis = 'Months';
//                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
//                            }
//                            if (v.Quarter) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
//                            }
//                        }
//                        if ($('#branchreport').val() == '2'){
//                            yaxis = 'Interest Earned (Naira)';
//                            caption = 'Interest Earned by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.branch , value: v.amount_received}, );
//                            if (v.PaymentYear){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.PaymentYear , value: v.amount_received}, );
//                            }
//                            if (v.monthpayed){
//                                agent = ': '+v.office;
//                                xaxis = 'Months';
//                                d.push({label: v.monthpayed , value: v.amount_received}, )
//                            }
//                            if (v.branchQuarter){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.branchQuarter , value: v.amount_received}, );
//                            }
//                        }
//                    });
//                    var chartConfigs = {
//                        type: 'mscolumn2d',
////                        renderAt: 'chart-container',
//                        width: '100%',
//                        height: '400',
//                        dataFormat: 'json',
//                        dataSource: {
//                            "chart": {
//                                "theme": "fusion",
//                                "caption": "Comparison of Branches",
//                                "xAxisname": "Quarter",
//                                "yAxisName": "Amount (In Naira)",
//                                "plotFillAlpha": "80",
//                                "divLineIsDashed": "1",
//                                "divLineDashLen": "1",
//                                "divLineGapLen": "1"
//                            },
//                            "categories": [{
//                                "category": [{
//                                    "label": "Q1"
//                                }, {
//                                    "label": "Q2"
//                                }, {
//                                    "label": "Q3"
//                                }, {
//                                    "label": "Q4"
//                                }]
//                            }],
//                            "dataset": [{
//                                "seriesname": "Previous Year",
//                                "data": [{
//                                    "value": "10000"
//                                }, {
//                                    "value": "11500"
//                                }, {
//                                    "value": "12500"
//                                }, {
//                                    "value": "15000"
//                                }]
//                            }, {
//                                "seriesname": "Current Year",
//                                "data": [{
//                                    "value": "25400"
//                                }, {
//                                    "value": "29800"
//                                }, {
//                                    "value": "21800"
//                                }, {
//                                    "value": "26800"
//                                }]
//                            }]
//                        }
//                    };
//                }
//                $("#branch-chart").insertFusionCharts(chartConfigs);
//            },
//            'error': function (err) {
//                swal('Error in Connection!','','error')
//            }
//        });
//    }

    function bFrequencyChange(frequency){
        let url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
        year = $('#branch-year').val(), report = $('#reportview').val(),
            branch = $('#chartfilterbranches').val();
        if (($('#reportview').val() == '1') && branch == 0){
            return swal('Please select a branch!', '','warning');
        }
        if (frequency.value == 2 || frequency.value == 4){
            $('#brn-year').show();
            if (branch && year){
                url = url.concat('branch='+branch+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#brn-year').hide();
            $('#branch-year').val(0);
            url = url.concat('branch='+branch+'&&freq='+frequency.value+'&&year='+$('#branch-year').val());
        }
        let d = [], series = '', agent = '', xaxis, yaxis, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (report == '1'){
                    jQuery.each(data.response, function(k, v){
                        if ($('#branchreport').val() == '1') {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            if (v.branch)
                                d.push({label: v.branch, value: v.amount_disbursed},);
                            if (v.year) {
                                agent = ': ' + v.office;
                                xaxis = 'Years'
                                d.push({label: v.year, value: v.AmountDisbursed},);
                            }
                            if (v.month) {
                                agent = ': ' + v.office;
                                xaxis = 'Months';
                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
                            }
                            if (v.Quarter) {
                                agent = ': ' + v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
                            }
                        }
                        if ($('#branchreport').val() == '2'){
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            if (v.branch)
                                d.push({label: v.branch , value: v.amount_received}, );
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Years'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Months';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                    });
                    var chartConfigs = {
                        type: 'column2d', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            // Chart Configuration
                            "chart": {
                                "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": xaxis,
                                "yAxisName": yaxis,
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            // Chart Data
                            "data": d
                        }
                    };
                    $("#branch-chart").insertFusionCharts(chartConfigs);
                }
                else if (report == '2'){
                    if ($('#branchreport').val() == '1') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.branch);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.branch === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.AmountDisbursed});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '2') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    var dConfigs = {
                        type: 'mscolumn2d',
                        renderAt: 'chart-container',
                        width: '100%',
                        height: '400',
                        dataFormat: 'json',
                        dataSource: {
                            "chart": {
                                "theme": "fusion",
                                "caption": caption,
                                "xAxisname": 'Period',
                                "yAxisName": "Amount (In Naira)",
                                "plotFillAlpha": "80",
                                "divLineIsDashed": "1",
                                "divLineDashLen": "1",
                                "divLineGapLen": "1"
                            },
                            "categories": [{'category': categories}],
                            "dataset": dataset
                        }
                    };
                    $("#branch-chart").insertFusionCharts(dConfigs);
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function bFilterYear(year) {
        let urlAn = ($('#reportview').val() == '1') ? '/user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
        let branch = $('#chartfilterbranches').val(), report = $('#reportview').val(),
            freq = $('#branch-frequency').val(),
            d=[], agent, xaxis, yaxis, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        if (($('#reportview').val() == '1') && branch == 0){
            return swal('Please choose a branch!', '', 'warning');
        }
        urlAn = urlAn.concat('freq='+freq+'&&branch='+branch+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
                if (report == '1'){
                    jQuery.each(data.response, function(k, v){
                        if ($('#branchreport').val() == '1') {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Disbursements by Branches';
                            if (v.branch)
                                d.push({label: v.branch, value: v.amount_disbursed},);
                            if (v.year) {
                                agent = ': ' + v.office;
                                xaxis = 'Years'
                                d.push({label: v.DisburseYear, value: v.AmountDisbursed},);
                            }
                            if (v.month) {
                                agent = ': ' + v.office;
                                xaxis = 'Months';
                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
                            }
                            if (v.Quarter) {
                                agent = ': ' + v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
                            }
                        }
                        if ($('#branchreport').val() == '2'){
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            if (v.branch)
                                d.push({label: v.branch , value: v.amount_received}, );
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Years'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Months';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                    });
                    var chartConfigs = {
                        type: 'column2d', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            // Chart Configuration
                            "chart": {
                                "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": xaxis,
                                "yAxisName": yaxis,
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            // Chart Data
                            "data": d
                        }
                    };
                    $("#branch-chart").insertFusionCharts(chartConfigs);
                }
                else if (report == '2'){
                    if ($('#branchreport').val() == '1') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.branch);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.branch === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.AmountDisbursed});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '2') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    var dConfigs = {
                        type: 'mscolumn2d',
                        renderAt: 'chart-container',
                        width: '100%',
                        height: '400',
                        dataFormat: 'json',
                        dataSource: {
                            "chart": {
                                "theme": "fusion",
                                "caption": caption,
                                "xAxisname": 'Period',
                                "yAxisName": "Amount (In Naira)",
                                "plotFillAlpha": "80",
                                "divLineIsDashed": "1",
                                "divLineDashLen": "1",
                                "divLineGapLen": "1"
                            },
                            "categories": [{'category': categories}],
                            "dataset": dataset
                        }
                    };
                    $("#branch-chart").insertFusionCharts(dConfigs);
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function changereport(type){
        $('#chartfilterbranches').val(0);
        $('#branch-frequency').val(-1);
        $('#branch-year').val(0);
        $('#brn-year').hide();
        return branches(type.value);
    }

    function changeview(type){
        if (type.value == '1'){
            $('#sel-brn').show();
        }else{
            $('#sel-brn').hide();
        }
    }

    // Payments

    function payments(){
        let d = [];
        let data = [
            {
                "label": "Venezuela",
                "value": "290"
            }, {
                "label": "Saudi",
                "value": "260"
            }, {
                "label": "Canada",
                "value": "180"
            }, {
                "label": "Iran",
                "value": "140"
            }, {
                "label": "Russia",
                "value": "115"
            }, {
                "label": "UAE",
                "value": "100"
            }, {
                "label": "US",
                "value": "30"
            }, {
                "label": "China",
                "value": "30"
            }];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=payments',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_payed}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function pFilterOfficer(officer){
        let url = '/user/analytics?t=payments&&',
            freq = $('#payment-frequency').val(),
            year = $('#payment-year').val();
        if (officer.value == 0){
            $('#payment-frequency').val(-1);
            $('#payment-year').val(0);
            $('#pay-year').hide();
            return payments();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#pay-year').hide();
            $('#payment-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else {
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pFrequencyChange(frequency){
        let url ='user/analytics?t=payments&&',
            year = $('#payment-year').val(),
            officer = $('#pchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#pay-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#pay-year').hide();
            $('#payment-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#payment-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pFilterYear(year) {
        let urlAn = '/user/analytics?t=payments&&';
        let officer = $('#pchartfilterofficers').val(),
            freq = $('#payment-frequency').val(),
            d=[], agent = '', xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Interests Received

    function interestreceived(){
        let d = [];
        let data = [
            {
                "label": "Venezuela",
                "value": "290"
            }, {
                "label": "Saudi",
                "value": "260"
            }, {
                "label": "Canada",
                "value": "180"
            }, {
                "label": "Iran",
                "value": "140"
            }, {
                "label": "Russia",
                "value": "115"
            }, {
                "label": "UAE",
                "value": "100"
            }, {
                "label": "US",
                "value": "30"
            }, {
                "label": "China",
                "value": "30"
            }];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=interest-received',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_received}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function irFilterOfficer(officer){
        let url = '/user/analytics?t=interest-received&&',
            freq = $('#ir-frequency').val(),
            year = $('#i-r-year').val();
        if (officer.value == 0 && freq == "-1"){
            return interestreceived();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#ir-year').hide();
            $('#i-r-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else{
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Period';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irFrequencyChange(frequency){
        let url ='user/analytics?t=interest-received&&',
            year = $('#i-r-year').val(),
            officer = $('#irchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#ir-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#ir-year').hide();
            $('#i-r-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#i-r-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irFilterYear(year) {
        let urlAn = '/user/analytics?t=interest-received&&';
        let officer = $('#irchartfilterofficers').val(),
            freq = $("#ir-frequency").val(),
            d=[], agent, xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, );
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, );
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, );
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, );
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, );
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

</script>

</body>
</html>
